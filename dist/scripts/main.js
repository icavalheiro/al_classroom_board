function createTable(){for(var e=$("table"),t=0;t<table.length;t++){var n=table[t],r="<tr>";r+="<td>"+n[0]+"</td>";for(var o=1;o<n.length;o++)r+='<td class="room-cell" id="'+t+"-"+o+'">'+n[o]+"</td>";r+="<tr>",e.append(r)}}function enableEditing(){function e(e){var t=e.find("textarea").val();e.remove("textarea");var n=e.attr("id").split("-");table[n[0]][n[1]]=t,-1==t.indexOf("\n")?e.text(t):e.html(t.split("\n").join("<br/>")),Cookies.set("al-rooms-cookie",table)}function t(t){var n=t.attr("id").split("-"),r=table[n[0]][n[1]];t.empty(),t.append('<textarea type="textarea"/></textarea>'),t.find("textarea").focus().focusout(function(){currentElement=null,e($($(this).parent()))}).val(r)}$("html").on("click",function(n){var r=$(n.target);if(currentElement){if(currentElement.attr("id")==r.attr("id")||$(r.parent()).attr("id")==currentElement.attr("id"))return;e(currentElement),currentElement=null}r.hasClass("room-cell")&&(currentElement=r,t(r))})}!function(e){var t=!1;if("function"==typeof define&&define.amd&&(define(e),t=!0),"object"==typeof exports&&(module.exports=e(),t=!0),!t){var n=window.Cookies,r=window.Cookies=e();r.noConflict=function(){return window.Cookies=n,r}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(n){function r(t,o,i){var a;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(i=e({path:"/"},r.defaults,i)).expires){var c=new Date;c.setMilliseconds(c.getMilliseconds()+864e5*i.expires),i.expires=c}i.expires=i.expires?i.expires.toUTCString():"";try{a=JSON.stringify(o),/^[\{\[]/.test(a)&&(o=a)}catch(e){}o=n.write?n.write(o,t):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var l="";for(var u in i)i[u]&&(l+="; "+u,!0!==i[u]&&(l+="="+i[u]));return document.cookie=t+"="+o+l}t||(a={});for(var d=document.cookie?document.cookie.split("; "):[],f=/(%[0-9A-Z]{2})+/g,s=0;s<d.length;s++){var p=d[s].split("="),m=p.slice(1).join("=");'"'===m.charAt(0)&&(m=m.slice(1,-1));try{var v=p[0].replace(f,decodeURIComponent);if(m=n.read?n.read(m,v):n(m,v)||m.replace(f,decodeURIComponent),this.json)try{m=JSON.parse(m)}catch(e){}if(t===v){a=m;break}t||(a[v]=m)}catch(e){}}return a}}return r.set=r,r.get=function(e){return r.call(r,e)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,n){r(t,"",e(n,{expires:-1}))},r.withConverter=t,r}return t(function(){})});var table=null,currentElement=null;$(document).ready(function(){table=Cookies.get("al-rooms-cookie")||[["8:30","","","","","","",""],["10:00","","","","","","",""],["13:00","","","","","","",""],["14:00","","","","","","",""],["15:30","","","","","","",""],["17:00","","","","","","",""],["18:30","","","","","","",""],["20:00","","","","","","",""]],createTable(),enableEditing()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ2ljLmpzIiwiY29va2llcy5qcyJdLCJuYW1lcyI6WyJjcmVhdGVUYWJsZSIsImRvbVRhYmxlIiwiJCIsImkiLCJ0YWJsZSIsImxlbmd0aCIsInJvdyIsImh0bWwiLCJqIiwiYXBwZW5kIiwiZW5hYmxlRWRpdGluZyIsInRlcm1pbmF0ZUVkaXRpbmciLCJlIiwiaW5wdXRWYWx1ZSIsImZpbmQiLCJ2YWwiLCJyZW1vdmUiLCJpZFNwbGl0IiwiYXR0ciIsInNwbGl0IiwiaW5kZXhPZiIsInRleHQiLCJqb2luIiwiQ29va2llcyIsInNldCIsImluaXRpYXRlRWRpdGluZyIsImN1cnJlbnRUZXh0IiwiZW1wdHkiLCJmb2N1cyIsImZvY3Vzb3V0IiwiY3VycmVudEVsZW1lbnQiLCJ0aGlzIiwicGFyZW50Iiwib24iLCJlbGVtZW50IiwidGFyZ2V0IiwiaGFzQ2xhc3MiLCJmYWN0b3J5IiwicmVnaXN0ZXJlZEluTW9kdWxlTG9hZGVyIiwiZGVmaW5lIiwiYW1kIiwiZXhwb3J0cyIsIm1vZHVsZSIsIk9sZENvb2tpZXMiLCJ3aW5kb3ciLCJhcGkiLCJub0NvbmZsaWN0IiwiZXh0ZW5kIiwicmVzdWx0IiwiYXJndW1lbnRzIiwiYXR0cmlidXRlcyIsImtleSIsImluaXQiLCJjb252ZXJ0ZXIiLCJ2YWx1ZSIsImRvY3VtZW50IiwicGF0aCIsImRlZmF1bHRzIiwiZXhwaXJlcyIsIkRhdGUiLCJzZXRNaWxsaXNlY29uZHMiLCJnZXRNaWxsaXNlY29uZHMiLCJ0b1VUQ1N0cmluZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0ZXN0Iiwid3JpdGUiLCJlbmNvZGVVUklDb21wb25lbnQiLCJTdHJpbmciLCJyZXBsYWNlIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiZXNjYXBlIiwic3RyaW5naWZpZWRBdHRyaWJ1dGVzIiwiYXR0cmlidXRlTmFtZSIsImNvb2tpZSIsImNvb2tpZXMiLCJyZGVjb2RlIiwicGFydHMiLCJzbGljZSIsImNoYXJBdCIsIm5hbWUiLCJyZWFkIiwianNvbiIsInBhcnNlIiwiZ2V0IiwiY2FsbCIsImdldEpTT04iLCJhcHBseSIsIndpdGhDb252ZXJ0ZXIiLCJyZWFkeSJdLCJtYXBwaW5ncyI6IkFBR0EsU0FBQUEsY0FFQSxJQUFBLElBREFDLEVBQUFDLEVBQUEsU0FDQUMsRUFBQSxFQUFBQSxFQUFBQyxNQUFBQyxPQUFBRixJQUFBLENBQ0EsSUFBQUcsRUFBQUYsTUFBQUQsR0FDQUksRUFBQSxPQUNBQSxHQUFBLE9BQUFELEVBQUEsR0FBQSxRQUNBLElBQUEsSUFBQUUsRUFBQSxFQUFBQSxFQUFBRixFQUFBRCxPQUFBRyxJQUNBRCxHQUFBLDZCQUFBSixFQUFBLElBQUFLLEVBQUEsS0FBQUYsRUFBQUUsR0FBQSxRQUVBRCxHQUFBLE9BRUFOLEVBQUFRLE9BQUFGLElBS0EsU0FBQUcsZ0JBQ0EsU0FBQUMsRUFBQUMsR0FDQSxJQUFBQyxFQUFBRCxFQUFBRSxLQUFBLFlBQUFDLE1BQ0FILEVBQUFJLE9BQUEsWUFDQSxJQUFBQyxFQUFBTCxFQUFBTSxLQUFBLE1BQUFDLE1BQUEsS0FDQWYsTUFBQWEsRUFBQSxJQUFBQSxFQUFBLElBQUFKLEdBRUEsR0FBQUEsRUFBQU8sUUFBQSxNQUNBUixFQUFBUyxLQUFBUixHQUVBRCxFQUFBTCxLQUFBTSxFQUFBTSxNQUFBLE1BQUFHLEtBQUEsVUFFQUMsUUFBQUMsSUFBQSxrQkFBQXBCLE9BR0EsU0FBQXFCLEVBQUFiLEdBQ0EsSUFBQUssRUFBQUwsRUFBQU0sS0FBQSxNQUFBQyxNQUFBLEtBQ0FPLEVBQUF0QixNQUFBYSxFQUFBLElBQUFBLEVBQUEsSUFDQUwsRUFBQWUsUUFDQWYsRUFBQUgsT0FBQSwwQ0FDQUcsRUFBQUUsS0FBQSxZQUFBYyxRQUFBQyxTQUFBLFdBQ0FDLGVBQUEsS0FDQW5CLEVBQUFULEVBQUFBLEVBQUE2QixNQUFBQyxhQUNBakIsSUFBQVcsR0FJQXhCLEVBQUEsUUFBQStCLEdBQUEsUUFBQSxTQUFBckIsR0FDQSxJQUFBc0IsRUFBQWhDLEVBQUFVLEVBQUF1QixRQUVBLEdBQUFMLGVBQUEsQ0FD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QixJQUFBcUIsRUFDQUEsRUFBQXVDLElBQUEsU0FBQWpDLEdBQ0EsT0FBQU4sRUFBQXdDLEtBQUF4QyxFQUFBTSxJQUVBTixFQUFBeUMsUUFBQSxXQUNBLE9BQUF6QyxFQUFBMEMsT0FDQUwsTUFBQSxNQUNBSixNQUFBTyxLQUFBcEMsYUFFQUosRUFBQVksWUFFQVosRUFBQTdCLE9BQUEsU0FBQW1DLEVBQUFELEdBQ0FMLEVBQUFNLEVBQUEsR0FBQUosRUFBQUcsR0FDQVEsU0FBQSxNQUlBYixFQUFBMkMsY0FBQXBDLEVBRUFQLEVBR0EsT0FBQU8sRUFBQSxnQkRuS0EsSUFBQWhELE1BQUEsS0FrQkEwQixlQUFBLEtBZ0RBNUIsRUFBQXFELFVBQUFrQyxNQUFBLFdBQ0FyRixNQUFBbUIsUUFBQTZELElBQUEsc0JBQ0EsT0FBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLEdBQUEsR0FBQSxLQUNBLFFBQUEsR0FBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLEdBQUEsS0FDQSxRQUFBLEdBQUEsR0FBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLEtBQ0EsUUFBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLEdBQUEsR0FBQSxLQUNBLFFBQUEsR0FBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLEdBQUEsS0FDQSxRQUFBLEdBQUEsR0FBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLEtBQ0EsUUFBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLEdBQUEsR0FBQSxLQUNBLFFBQUEsR0FBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLEdBQUEsS0FFQXBGLGNBQ0FVIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgdGFibGUgPSBudWxsO1xuXG5cbmZ1bmN0aW9uIGNyZWF0ZVRhYmxlKCl7XG4gICAgdmFyIGRvbVRhYmxlID0gJCgndGFibGUnKTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGFibGUubGVuZ3RoOyBpKyspe1xuICAgICAgICB2YXIgcm93ID0gdGFibGVbaV07XG4gICAgICAgIHZhciBodG1sID0gJzx0cj4nO1xuICAgICAgICBodG1sICs9ICc8dGQ+JyArIHJvd1swXSArICc8L3RkPic7XG4gICAgICAgIGZvcih2YXIgaiA9IDE7IGogPCByb3cubGVuZ3RoOyBqKyspe1xuICAgICAgICAgICAgaHRtbCArPSAnPHRkIGNsYXNzPVwicm9vbS1jZWxsXCIgaWQ9XCInICsgaSArICctJyArIGogKyAnXCI+Jytyb3dbal0rJzwvdGQ+JztcbiAgICAgICAgfVxuICAgICAgICBodG1sICs9ICc8dHI+JztcblxuICAgICAgICBkb21UYWJsZS5hcHBlbmQoaHRtbCk7XG4gICAgfVxufVxuXG52YXIgY3VycmVudEVsZW1lbnQgPSBudWxsO1xuZnVuY3Rpb24gZW5hYmxlRWRpdGluZygpe1xuICAgIGZ1bmN0aW9uIHRlcm1pbmF0ZUVkaXRpbmcoZSl7XG4gICAgICAgIHZhciBpbnB1dFZhbHVlID0gZS5maW5kKCd0ZXh0YXJlYScpLnZhbCgpO1xuICAgICAgICBlLnJlbW92ZSgndGV4dGFyZWEnKTtcbiAgICAgICAgdmFyIGlkU3BsaXQgPSBlLmF0dHIoJ2lkJykuc3BsaXQoJy0nKTtcbiAgICAgICAgdGFibGVbaWRTcGxpdFswXV1baWRTcGxpdFsxXV0gPSBpbnB1dFZhbHVlO1xuXG4gICAgICAgIGlmKGlucHV0VmFsdWUuaW5kZXhPZignXFxuJykgPT0gLTEpXG4gICAgICAgICAgICBlLnRleHQoaW5wdXRWYWx1ZSk7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGUuaHRtbChpbnB1dFZhbHVlLnNwbGl0KCdcXG4nKS5qb2luKCc8YnIvPicpKTtcblxuICAgICAgICBDb29raWVzLnNldCgnYWwtcm9vbXMtY29va2llJywgdGFibGUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluaXRpYXRlRWRpdGluZyhlKXtcbiAgICAgICAgdmFyIGlkU3BsaXQgPSBlLmF0dHIoJ2lkJykuc3BsaXQoJy0nKTtcbiAgICAgICAgdmFyIGN1cnJlbnRUZXh0ID0gdGFibGVbaWRTcGxpdFswXV1baWRTcGxpdFsxXV07XG4gICAgICAgIGUuZW1wdHkoKTtcbiAgICAgICAgZS5hcHBlbmQoJzx0ZXh0YXJlYSB0eXBlPVwidGV4dGFyZWFcIi8+PC90ZXh0YXJlYT4nKTtcbiAgICAgICAgZS5maW5kKCd0ZXh0YXJlYScpLmZvY3VzKCkuZm9jdXNvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGN1cnJlbnRFbGVtZW50ID0gbnVsbDtcbiAgICAgICAgICAgIHRlcm1pbmF0ZUVkaXRpbmcoJCgkKHRoaXMpLnBhcmVudCgpKSk7XG4gICAgICAgIH0pLnZhbChjdXJyZW50VGV4dCk7XG4gICAgfVxuXG5cbiAgICAkKCdodG1sJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSl7XG4gICAgICAgIHZhciBlbGVtZW50ID0gJChlLnRhcmdldCk7XG5cbiAgICAgICAgaWYoY3VycmVudEVsZW1lbnQpe1xuICAgICAgICAgICAgaWYoY3VycmVudEVsZW1lbnQuYXR0cignaWQnKSA9PSBlbGVtZW50LmF0dHIoJ2lkJylcbiAgICAgICAgICAgIHx8ICQoZWxlbWVudC5wYXJlbnQoKSkuYXR0cignaWQnKSA9PSBjdXJyZW50RWxlbWVudC5hdHRyKCdpZCcpKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgdGVybWluYXRlRWRpdGluZyhjdXJyZW50RWxlbWVudCk7XG4gICAgICAgICAgICBjdXJyZW50RWxlbWVudCA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZihlbGVtZW50Lmhhc0NsYXNzKCdyb29tLWNlbGwnKSl7XG5cbiAgICAgICAgICAgIGN1cnJlbnRFbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgICAgIGluaXRpYXRlRWRpdGluZyhlbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgdGFibGUgPSBDb29raWVzLmdldCgnYWwtcm9vbXMtY29va2llJykgfHwgW1xuICAgICAgICBbICc4OjMwJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJyddLFxuICAgICAgICBbJzEwOjAwJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJyddLFxuICAgICAgICBbJzEzOjAwJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJyddLFxuICAgICAgICBbJzE0OjAwJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJyddLFxuICAgICAgICBbJzE1OjMwJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJyddLFxuICAgICAgICBbJzE3OjAwJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJyddLFxuICAgICAgICBbJzE4OjMwJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJyddLFxuICAgICAgICBbJzIwOjAwJywgJycsICcnLCAnJywgJycsICcnLCAnJywgJyddXG4gICAgXTtcbiAgICBjcmVhdGVUYWJsZSgpO1xuICAgIGVuYWJsZUVkaXRpbmcoKTtcbn0pOyIsIi8qIVxuICogSmF2YVNjcmlwdCBDb29raWUgdjIuMS40XG4gKiBodHRwczovL2dpdGh1Yi5jb20vanMtY29va2llL2pzLWNvb2tpZVxuICpcbiAqIENvcHlyaWdodCAyMDA2LCAyMDE1IEtsYXVzIEhhcnRsICYgRmFnbmVyIEJyYWNrXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2VcbiAqL1xuOyhmdW5jdGlvbiAoZmFjdG9yeSkge1xuXHR2YXIgcmVnaXN0ZXJlZEluTW9kdWxlTG9hZGVyID0gZmFsc2U7XG5cdGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcblx0XHRkZWZpbmUoZmFjdG9yeSk7XG5cdFx0cmVnaXN0ZXJlZEluTW9kdWxlTG9hZGVyID0gdHJ1ZTtcblx0fVxuXHRpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKSB7XG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdFx0cmVnaXN0ZXJlZEluTW9kdWxlTG9hZGVyID0gdHJ1ZTtcblx0fVxuXHRpZiAoIXJlZ2lzdGVyZWRJbk1vZHVsZUxvYWRlcikge1xuXHRcdHZhciBPbGRDb29raWVzID0gd2luZG93LkNvb2tpZXM7XG5cdFx0dmFyIGFwaSA9IHdpbmRvdy5Db29raWVzID0gZmFjdG9yeSgpO1xuXHRcdGFwaS5ub0NvbmZsaWN0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0d2luZG93LkNvb2tpZXMgPSBPbGRDb29raWVzO1xuXHRcdFx0cmV0dXJuIGFwaTtcblx0XHR9O1xuXHR9XG59KGZ1bmN0aW9uICgpIHtcblx0ZnVuY3Rpb24gZXh0ZW5kICgpIHtcblx0XHR2YXIgaSA9IDA7XG5cdFx0dmFyIHJlc3VsdCA9IHt9O1xuXHRcdGZvciAoOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgYXR0cmlidXRlcyA9IGFyZ3VtZW50c1sgaSBdO1xuXHRcdFx0Zm9yICh2YXIga2V5IGluIGF0dHJpYnV0ZXMpIHtcblx0XHRcdFx0cmVzdWx0W2tleV0gPSBhdHRyaWJ1dGVzW2tleV07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH1cblxuXHRmdW5jdGlvbiBpbml0IChjb252ZXJ0ZXIpIHtcblx0XHRmdW5jdGlvbiBhcGkgKGtleSwgdmFsdWUsIGF0dHJpYnV0ZXMpIHtcblx0XHRcdHZhciByZXN1bHQ7XG5cdFx0XHRpZiAodHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJykge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8vIFdyaXRlXG5cblx0XHRcdGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuXHRcdFx0XHRhdHRyaWJ1dGVzID0gZXh0ZW5kKHtcblx0XHRcdFx0XHRwYXRoOiAnLydcblx0XHRcdFx0fSwgYXBpLmRlZmF1bHRzLCBhdHRyaWJ1dGVzKTtcblxuXHRcdFx0XHRpZiAodHlwZW9mIGF0dHJpYnV0ZXMuZXhwaXJlcyA9PT0gJ251bWJlcicpIHtcblx0XHRcdFx0XHR2YXIgZXhwaXJlcyA9IG5ldyBEYXRlKCk7XG5cdFx0XHRcdFx0ZXhwaXJlcy5zZXRNaWxsaXNlY29uZHMoZXhwaXJlcy5nZXRNaWxsaXNlY29uZHMoKSArIGF0dHJpYnV0ZXMuZXhwaXJlcyAqIDg2NGUrNSk7XG5cdFx0XHRcdFx0YXR0cmlidXRlcy5leHBpcmVzID0gZXhwaXJlcztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFdlJ3JlIHVzaW5nIFwiZXhwaXJlc1wiIGJlY2F1c2UgXCJtYXgtYWdlXCIgaXMgbm90IHN1cHBvcnRlZCBieSBJRVxuXHRcdFx0XHRhdHRyaWJ1dGVzLmV4cGlyZXMgPSBhdHRyaWJ1dGVzLmV4cGlyZXMgPyBhdHRyaWJ1dGVzLmV4cGlyZXMudG9VVENTdHJpbmcoKSA6ICcnO1xuXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0cmVzdWx0ID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xuXHRcdFx0XHRcdGlmICgvXltcXHtcXFtdLy50ZXN0KHJlc3VsdCkpIHtcblx0XHRcdFx0XHRcdHZhbHVlID0gcmVzdWx0O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBjYXRjaCAoZSkge31cblxuXHRcdFx0XHRpZiAoIWNvbnZlcnRlci53cml0ZSkge1xuXHRcdFx0XHRcdHZhbHVlID0gZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyh2YWx1ZSkpXG5cdFx0XHRcdFx0XHQucmVwbGFjZSgvJSgyM3wyNHwyNnwyQnwzQXwzQ3wzRXwzRHwyRnwzRnw0MHw1Qnw1RHw1RXw2MHw3Qnw3RHw3QykvZywgZGVjb2RlVVJJQ29tcG9uZW50KTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR2YWx1ZSA9IGNvbnZlcnRlci53cml0ZSh2YWx1ZSwga2V5KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGtleSA9IGVuY29kZVVSSUNvbXBvbmVudChTdHJpbmcoa2V5KSk7XG5cdFx0XHRcdGtleSA9IGtleS5yZXBsYWNlKC8lKDIzfDI0fDI2fDJCfDVFfDYwfDdDKS9nLCBkZWNvZGVVUklDb21wb25lbnQpO1xuXHRcdFx0XHRrZXkgPSBrZXkucmVwbGFjZSgvW1xcKFxcKV0vZywgZXNjYXBlKTtcblxuXHRcdFx0XHR2YXIgc3RyaW5naWZpZWRBdHRyaWJ1dGVzID0gJyc7XG5cblx0XHRcdFx0Zm9yICh2YXIgYXR0cmlidXRlTmFtZSBpbiBhdHRyaWJ1dGVzKSB7XG5cdFx0XHRcdFx0aWYgKCFhdHRyaWJ1dGVzW2F0dHJpYnV0ZU5hbWVdKSB7XG5cdFx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0c3RyaW5naWZpZWRBdHRyaWJ1dGVzICs9ICc7ICcgKyBhdHRyaWJ1dGVOYW1lO1xuXHRcdFx0XHRcdGlmIChhdHRyaWJ1dGVzW2F0dHJpYnV0ZU5hbWVdID09PSB0cnVlKSB7XG5cdFx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0c3RyaW5naWZpZWRBdHRyaWJ1dGVzICs9ICc9JyArIGF0dHJpYnV0ZXNbYXR0cmlidXRlTmFtZV07XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIChkb2N1bWVudC5jb29raWUgPSBrZXkgKyAnPScgKyB2YWx1ZSArIHN0cmluZ2lmaWVkQXR0cmlidXRlcyk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFJlYWRcblxuXHRcdFx0aWYgKCFrZXkpIHtcblx0XHRcdFx0cmVzdWx0ID0ge307XG5cdFx0XHR9XG5cblx0XHRcdC8vIFRvIHByZXZlbnQgdGhlIGZvciBsb29wIGluIHRoZSBmaXJzdCBwbGFjZSBhc3NpZ24gYW4gZW1wdHkgYXJyYXlcblx0XHRcdC8vIGluIGNhc2UgdGhlcmUgYXJlIG5vIGNvb2tpZXMgYXQgYWxsLiBBbHNvIHByZXZlbnRzIG9kZCByZXN1bHQgd2hlblxuXHRcdFx0Ly8gY2FsbGluZyBcImdldCgpXCJcblx0XHRcdHZhciBjb29raWVzID0gZG9jdW1lbnQuY29va2llID8gZG9jdW1lbnQuY29va2llLnNwbGl0KCc7ICcpIDogW107XG5cdFx0XHR2YXIgcmRlY29kZSA9IC8oJVswLTlBLVpdezJ9KSsvZztcblx0XHRcdHZhciBpID0gMDtcblxuXHRcdFx0Zm9yICg7IGkgPCBjb29raWVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHZhciBwYXJ0cyA9IGNvb2tpZXNbaV0uc3BsaXQoJz0nKTtcblx0XHRcdFx0dmFyIGNvb2tpZSA9IHBhcnRzLnNsaWNlKDEpLmpvaW4oJz0nKTtcblxuXHRcdFx0XHRpZiAoY29va2llLmNoYXJBdCgwKSA9PT0gJ1wiJykge1xuXHRcdFx0XHRcdGNvb2tpZSA9IGNvb2tpZS5zbGljZSgxLCAtMSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdHZhciBuYW1lID0gcGFydHNbMF0ucmVwbGFjZShyZGVjb2RlLCBkZWNvZGVVUklDb21wb25lbnQpO1xuXHRcdFx0XHRcdGNvb2tpZSA9IGNvbnZlcnRlci5yZWFkID9cblx0XHRcdFx0XHRcdGNvbnZlcnRlci5yZWFkKGNvb2tpZSwgbmFtZSkgOiBjb252ZXJ0ZXIoY29va2llLCBuYW1lKSB8fFxuXHRcdFx0XHRcdFx0Y29va2llLnJlcGxhY2UocmRlY29kZSwgZGVjb2RlVVJJQ29tcG9uZW50KTtcblxuXHRcdFx0XHRcdGlmICh0aGlzLmpzb24pIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGNvb2tpZSA9IEpTT04ucGFyc2UoY29va2llKTtcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKGtleSA9PT0gbmFtZSkge1xuXHRcdFx0XHRcdFx0cmVzdWx0ID0gY29va2llO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKCFrZXkpIHtcblx0XHRcdFx0XHRcdHJlc3VsdFtuYW1lXSA9IGNvb2tpZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0fVxuXG5cdFx0YXBpLnNldCA9IGFwaTtcblx0XHRhcGkuZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xuXHRcdFx0cmV0dXJuIGFwaS5jYWxsKGFwaSwga2V5KTtcblx0XHR9O1xuXHRcdGFwaS5nZXRKU09OID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0cmV0dXJuIGFwaS5hcHBseSh7XG5cdFx0XHRcdGpzb246IHRydWVcblx0XHRcdH0sIFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKSk7XG5cdFx0fTtcblx0XHRhcGkuZGVmYXVsdHMgPSB7fTtcblxuXHRcdGFwaS5yZW1vdmUgPSBmdW5jdGlvbiAoa2V5LCBhdHRyaWJ1dGVzKSB7XG5cdFx0XHRhcGkoa2V5LCAnJywgZXh0ZW5kKGF0dHJpYnV0ZXMsIHtcblx0XHRcdFx0ZXhwaXJlczogLTFcblx0XHRcdH0pKTtcblx0XHR9O1xuXG5cdFx0YXBpLndpdGhDb252ZXJ0ZXIgPSBpbml0O1xuXG5cdFx0cmV0dXJuIGFwaTtcblx0fVxuXG5cdHJldHVybiBpbml0KGZ1bmN0aW9uICgpIHt9KTtcbn0pKTsiXX0=
